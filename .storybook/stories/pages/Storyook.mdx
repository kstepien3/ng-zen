# Storybook Configuration

> **Note**: This documentation serves as a configuration pattern for setting up Storybook with Angular and Compodoc. The specific configuration details may vary depending on your project's needs and structure.

This document outlines the custom Storybook configuration used in this project to help you set up similar documentation in your own projects.

## Compodoc Integration

The project uses [Compodoc](https://compodoc.app/) to generate comprehensive Angular documentation that integrates seamlessly with Storybook.

### Configuration (angular.json)

```
"compodocArgs": ["-e", "json", "-d", "./documentation/", "--disablePrivate", "--disableProtected"]
```

**Key Configuration Details:**

- **`-e json`**: Exports documentation in JSON format for Storybook consumption
- **`-d ./documentation/`**: Outputs documentation to the documentation directory
- **`--disablePrivate`**: Excludes private class members from documentation (not relevant for component API documentation)
- **`--disableProtected`**: Excludes protected class members from documentation (not relevant for component API documentation)

The `disablePrivate` and `disableProtected` flags are used because private and protected properties/methods are typically implementation details that don't need to be documented for component consumers in Storybook.

## Storybook Configuration

### Main Configuration (.storybook/main.ts)

```typescript
import { StorybookConfig } from '@storybook/angular';

const config: StorybookConfig = {
  stories: ['./stories/**/*.@(js|jsx|ts|tsx|mdx)', '../src/**/*.stories.@(ts)'],
  addons: ['@storybook/addon-links', '@chromatic-com/storybook', '@storybook/addon-docs'],
  framework: '@storybook/angular',
  docs: {
    defaultName: 'Docs',
  },
};
```

**Custom Story Sources:**

- **Documentation Pages**: `./stories/**/*.@(js|jsx|ts|tsx|mdx)` - Contains documentation pages like this one
- **Generated Code**: `../src/**/*.stories.@(ts)` - Automatically includes stories from generated code

### Preview Configuration (.storybook/preview.ts)

```ts
import { setCompodocJson } from '@storybook/addon-docs/angular';
import { Preview } from '@storybook/angular';
import docJson from '../documentation/documentation.json';
setCompodocJson(docJson);

const preview: Preview = {
  parameters: {
    layout: 'centered',
    docs: {
      codePanel: true,
    },
  },
  tags: ['autodocs'],
};
```

**Key Features:**

- **Compodoc Integration**: Imports and sets the generated JSON documentation for automatic docs generation
  - The `import docJson from '../documentation/documentation.json'` path points to the JSON file generated by Compodoc
  - This file is automatically created when running Storybook builds based on the `compodocArgs` configuration in angular.json
- **Centered Layout**: Components are displayed centered by default
- **Code Panel**: Enables the code panel in documentation
- **Auto Documentation**: `autodocs` tag automatically generates documentation for components

## Code Generation with Stories

This project includes a custom Angular schematic that can generate code with accompanying Storybook stories.

### Usage

```bash
ng generate @ng-zen/cli:ui ./src/app/ui --components avatar button --stories
```

**Parameters:**

- **`./src/app/ui`**: Target directory for component generation
- **`--components avatar button`**: Specify which components to generate (multiple supported)
- **`--stories`**: Flag to include Storybook stories for each component

### Story Template Structure

Generated stories follow a consistent pattern:

```ts
// if additional parameters are needed, then uncomment the following code:

// interface StoryParams {
//   // ... Optional additional story parameters. It can be removed if not needed.
// }
// type Options = ZenComponent & StoryParams;

type Options = ZenComponent


export default {
  title: 'Type/FeatureName',
  component: ZenComponent,
  args: {
    // Default values
  },
  argTypes: {
    // Control definitions with categories
    property: {
      control: 'controlType',
      table: {
        category: 'categoryName',
        type: { summary: 'type' },
      },
    },
  },
} satisfies Meta<Options>;
```

**ArgTypes Enhancement:**
Components may use extra documentation beyond Compodoc when auto-generated code needs specific improvements.
The rest of the code documentation is typically handled by Compodoc automatically. Categories in argTypes can vary but commonly include Angular-specific types like `inputs`, `outputs`, `models`, and others based on component needs.


In other cases, the category props can uses the examples like below for better demo documentation. See an example below for more details.

**Story Structure Features:**

- **Categorized Controls**: ArgTypes are organized into logical categories for better organization (e.g., "story parameters", "attributes")

## Development Workflow

1. **Generate Code**: Use the schematic with `--stories` flag to create code with stories
2. **Documentation Generation**: Compodoc automatically generates JSON documentation during Storybook builds
3. **Story Integration**: Stories are automatically discovered from the schematics directory
4. **Documentation Pages**: Add custom documentation pages in `.storybook/stories/pages/` (this location can be configured differently based on your project structure)

## Build Output

- **Development**: Served directly via `ng run cli:storybook`
- **Production Build**: Outputs to `dist/storybook` directory

This configuration provides a comprehensive documentation system that combines automatic API documentation with interactive component stories.
